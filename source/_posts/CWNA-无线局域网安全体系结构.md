---
title: 'CWNA:无线局域网安全体系结构'
date: 2022-02-25 16:22:49
tags: 'Wi-Fi'
---

无线局域网安全基础知识
> 数据隐私与完整性
> 身份验证、授权与记账
> 分段
> 监控与策略

遗留安全机制
> 遗留的身份验证机制
> 静态WEP加密
> MAC过滤
> SSID隐藏

强健安全机制
> 强健安全网络
> 身份验证与授权
> 预共享密钥身份验证
> 专有的预共享密钥身份验证
> 对等实体同时验证
> 802.1X/EAP框架
> EAP类型
> 动态加密密钥生成
> 四次握手
> 无线局域网加密
> TKIP加密
> CCMP加密
> CGMP加密

流量分段
> 虚拟局域网
> 基于角色的访问控制

WPA3

虚拟专用网安全
> VPN基础知识
> 三层VPN
> SSL VPN
> VPN部署

### 无线局域网安全基础知识
考虑射频信号传输的无缚性和开放性，为确保数据隐私，采用强有力的加密机制必不可少。

**数据隐私与完整性**
在计算机行业中，将明文转换为密文的过程通常称为加密。
将密文还原称明文的过程称为解密。

ARC4算法是一种流密码。
AES算法安全性优于ARC4流密码的分组密码。


WEP采用完整性校验值（ICV）
TKIP采用消息完整性校验（MIC）
CCMP采用消息完整性校验（MIC），不过安全性由于TKIP或WEP的数据完整性机制。

**身份验证、授权与记账（AAA）**
身份验证，验证身份和凭证是否有效。

授权，决定是否给予用户或设备访问网络资源的权限。

记账，跟踪用户或设备使用网络资源的情况。

**分段**
目的是在网络中分隔用户流量。
分段能结合基于角色的访问控制使用。

**监控与策略**
监控无线网络的性能；
监控无线网络的攻击和入侵。

### 遗留安全机制
遗留的安全机制早已破解。

**遗留的身份验证机制**
802.11原始标准定义了两种身份验证机制：开放系统身份验证  和  共享密钥身份验证。

遗留的身份验证机制与其说是验证用户身份，不如说是验证功能，其目的是确定两台设备是否为合法的802.11设备。

共享密钥身份验证采用WEP验证客户端都能通过验证，并关联到接入点后获得网络资源的访问权限，需要4次身份验证帧：
1）客户端向接入点发送身份验证请求帧；
2）接入点向客户端发送包含明文质询消息的身份验证响应帧；
3）客户端加密明文质询消息，将其封装到另一个身份验证请求帧并发生给接入点。
4）接入点解密客户端质询消息，并与原质询消息比较。
如果二者匹配，验证成功；
如果二者不匹配，拒绝客户端的身份验证请求。

安全隐患：任何人只有截获接入点的明文质询消息以及客户端返回的加密质询消息，就可能提取静态WEP密钥。攻击者一旦破解WEP密钥，
就可以之间破解数据帧并之间访问网络，网络将无密码可言。

**静态WEP加密**
WEP旨在实现3个目标：
机密性，在传输前加密数据以提供隐私性。
访问控制，一种简单的授权形式。
数据完整性，加密前需要计算数据完整性和（ICV），防止数据遭到篡改。

64位WEP称为WEP-40, 由40位静态密钥和24位初始化向量构成。 由10个16进制或5个ASCII字符构成。
128位WEP称为WEP-104, 由104位静态密钥和24位出生向量构成。由26个16进制或13个ASCII字符构成。

客户端和接入点最多能配置4把独立的静态WEP密钥，用户可选择一把作为默认的静态密钥。 可以采用不同的密钥分别加密发送流量和接收流量。

WEP存在大量安全隐患，4种主要的攻击：
IV冲突攻击， 由于24位的IV以明文形式传输且每一帧的IV都不同，如果采用WEP加密的流量大，那么IV在一定时间内必定重复。如果冲突发送，攻击者很容易破解密钥。

弱密钥攻击， ARC4会生成一部分弱IV密钥。通过恢复已知的弱IV密钥，攻击者很容易破解密码。

回注攻击， 对流量较少的网络，攻击者利用黑客工具发动数据包回注攻击，以加快收集弱IV密钥的速率。

比特翻转攻击， ICV数据完整性校验安全性较差，经过WEP加密的数据包可能遭到篡改。

**MAC过滤**
每块网卡有唯一的物理地址，MAC地址。
所有的MAC过滤都是特定于供应商的。
MAC地址可以欺骗或假冒。

由于MAC地址容易遭到欺骗且配置MAC过滤器比较烦琐，因此MAC过滤并非包含企业无线网的可靠手段。

**SSID隐藏**
多少接入点提供封闭网络，隐藏SSID或隐身模式的设置，启用后就能隐藏无线网络的名称。 这时信标帧的SSID字段位空。

启用封闭网络的接入点仍然会响应发送定向探询请求帧（包含特定SSID）的客户端。如此一来，合法的用户仍然可以通过身份验证并关联到接入点，
而没有配置正确SSID的客户端无法通过身份验证或关联到客户端。

只有使用合适的工具，通常只需要几秒的时间就可以发送隐藏的SSID。强烈建议不要隐藏SSID。
