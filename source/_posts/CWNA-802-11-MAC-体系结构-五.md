---
title: 'CWNA:802.11 MAC 体系结构(五)'
date: 2022-02-21 10:11:39
tags: 'Wi-Fi'
---

### 数据帧
IEEE802.11-2016标准定义了15种数据子类型，11种仅停留在纸面上，4种实际存在的。
> 数据帧（DATA）
> 空帧（null data)
> Qos数据帧(Qos Data)
> Qos空帧(Qos null data)

只要非Qos 设备作为发送方或接收方参与通信，就必须使用非Qos数据帧。

**不携带数据的数据帧**
仅由帧头和帧尾构成，帧体中没有MSDU数据。

如果客户端希望通知接入点自己的节电状态有所变化，那么可以调整空帧的电源管理位。
客户端决定进行信道外扫描时，将向接入点发送一个电源管理位设置为1的空功能帧，收到这个帧后，接入点将就所有传输给客户端的802.11帧存储在缓冲区。
当客户端返回接入点所在的信道时，将向接入点发送另一个电源管理位设置为0的空功能帧。收到这个空功能帧后，接入点就向客户端发送缓冲帧。（可提高吞吐量）

### 电源管理
无线主要提供了客户端的移动性，客户端一般使用电池，电源管理主要是为了提高设备的续航能力。

**遗留的电源管理机制**
主动模式是早期802.11终端使用的电源管理模式，无线终端随时准备发送和接收数据。它不提供任何节电功能。使用该模式的终端获得更高的吞吐量，但电池使用时间通常要更短。
应将始终与电源相连的终端配置为主动模式。

节电模式，客户端将在一段时间内关闭部分收发组件以减少耗电。

1.流量指示图
加入基本服务集的客户端将电源管理位设置为1，以此通知接入点启用节电模式。接入点获知客户端处于节电模式，随后将收到的传输给客户端的数据存储在缓冲区中。每当客户端
关联到接入点时，都会收到关联标识符（AID），接入点通过AID来跟踪与自己建立关联且加入基本服务集的客户端。如果接入点缓冲了客户端的数据，将在下一次发送信标帧时，
信标帧的流量指示图（TIM）字段就会包括客户端的AID。TIM字段列出了所有需要接收数据的客户端，这些数据存储在接入点的缓冲区中。每个信标帧都会携带客户端的AID，直到
缓冲区数据传输完毕。

信标帧根据一致的预定时间传输，这段时间称为目标信标传输时间（TBTT）。客户端在短时间内继续保持休眠状态，并及时切换到唤醒状态侦听信标帧。客户端不必在每次信标帧
发送时保持唤醒状态。

客户端收到信标帧的时候，将查看自己的AID是否出现在TIM中，如果存在，客户端将保持唤醒并向接入点发送节电轮询帧。接入点收到节电轮询帧后，将向客户端发送数据单播帧。
每个单播帧保护长度1比特的更多数据字段，如果是1，客户端不进入休眠状态继续接收数据。不过客户端需要继续发送ps-poll帧。
当更多数据字段为0时，客户端重新进入休眠。

2.发送流量指示图
多播和广播流量传输期间，发送流量指示图（DTIM)用于确保所有使用电源管理的终端保持唤醒状态。

**WMM节电与非调度自动节电传输**
802.11e定义了改进的电源管理机制，自动节电传输（APSD）。分为两种
调度自动节电传输（S-APSD）
非调度自动节电传输（U-APSD）

改进后的优点：
> 应用可以通过设置休眠期并发送触发帧来控制节电行为。
> 触发帧和交付方法可以取代节电轮询帧。
> 客户端可以请求下载缓冲数据，不必等待信标帧。
> TXOP期间，接入点可以在更快的帧突发中传输所有下行应用流量。

**MIMO电源管理机制**
空间复用节电，仅保持一条射频链，关闭其他射频链。
